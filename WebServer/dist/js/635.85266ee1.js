"use strict";(self["webpackChunkwebserve"]=self["webpackChunkwebserve"]||[]).push([[635],{635:function(e,t,s){s.r(t),s.d(t,{default:function(){return f}});var a=s(3396),i=s(7139),n=s(9242);const l={class:"container"},r=(0,a._)("div",null,"因为服务器算力较差，所以这个模块对于图片加载可能会很慢，即使我用了更加强大的技术，还是会有点慢",-1),u=(0,a._)("div",null,"所以请耐心等待，如果图片加载不出来，可以刷新一下页面",-1),h={class:"input-area"},o={class:"display-area"},d=["src"],m={style:{padding:"14px"}};function c(e,t,s,c,g,p){const y=(0,a.up)("el-button"),w=(0,a.up)("el-card"),f=(0,a.up)("el-col"),v=(0,a.up)("el-row");return(0,a.wg)(),(0,a.iD)("div",l,[r,u,(0,a._)("div",null,"用户："+(0,i.zw)(g.username),1),(0,a._)("div",h,[(0,a.wy)((0,a._)("textarea",{"onUpdate:modelValue":t[0]||(t[0]=e=>g.inputText=e),placeholder:"输入文字"},null,512),[[n.nr,g.inputText]]),(0,a._)("input",{type:"file",onChange:t[1]||(t[1]=(...e)=>p.selectImage&&p.selectImage(...e)),accept:"image/*"},null,32),(0,a.Wm)(y,{type:"primary",onClick:t[2]||(t[2]=e=>p.sendMessage("ruleForm"))},{default:(0,a.w5)((()=>[(0,a.Uk)("发送")])),_:1})]),(0,a._)("div",o,[(0,a.Wm)(v,null,{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(g.messages,((e,t)=>((0,a.wg)(),(0,a.j4)(f,{key:t,class:"message"},{default:(0,a.w5)((()=>[(0,a.Wm)(w,{"body-style":{padding:"0px"}},{default:(0,a.w5)((()=>[e.image?((0,a.wg)(),(0,a.iD)("img",{key:0,src:e.image,alt:"发送的图片",style:{"max-width":"100%",height:"auto"}},null,8,d)):(0,a.kq)("",!0),(0,a._)("div",m,[(0,a._)("p",null,(0,i.zw)(e.text),1)])])),_:2},1024)])),_:2},1024)))),128))])),_:1})])])}s(560);var g=s(1076),p={name:"DynamicPage",data(){return{inputText:"",selectedImage:null,messages:[],username:"",year:"",month:"",day:"",hour:"",minute:"",second:""}},mounted(){this.loadHistoryDyn(),this.username=this.$route.query.username;const e=new Date,t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Shanghai"},s=e.toLocaleString("en-US",t).split(", ")[0],a=e.toLocaleString("en-US",t).split(", ")[1];[this.month,this.day,this.year]=s.split("/"),[this.hour,this.minute,this.second]=a.split(":")},methods:{loadHistoryDyn(){g.Z.get("http://localhost:8081/api/history-dynamics").then((e=>{for(var t=e.data.msg,s=e.data.user,a=e.data.dyn,i=0;i<t.length;i++){var n={text:s[i]+":"+t[i],image:"data:image/jpeg;base64,"+a[i]};this.messages.push(n)}})).catch((e=>{console.error("Failed to load history messages:",e)}))},selectImage(e){this.selectedImage=e.target.files[0]},sendMessage(){const e={text:this.username+":"+this.year+"年"+this.month+"月"+this.day+"日"+this.hour+"时"+this.minute+"分"+this.second+"秒 写到："+this.inputText,image:null};if(this.selectedImage){const t=new FileReader;t.onload=()=>{e.image=t.result,console.log(t.result);const s=t.result.split(",")[1];g.Z.get("http://localhost:8081/api/send-dynamics",{params:{msg:this.year+"年"+this.month+"月"+this.day+"日"+this.hour+"时"+this.minute+"分"+this.second+"秒 写到："+this.inputText,img:s,user:this.username}}).then((t=>{"right"==t.data.state?(alert("发送成功"),this.messages.push(e),this.clearInput()):alert("发送失败")})).catch((e=>{console.error("Failed to send message:",e)}))},t.readAsDataURL(this.selectedImage)}else this.messages.push(e),this.clearInput()},clearInput(){this.inputText="",this.selectedImage=null}}},y=s(89);const w=(0,y.Z)(p,[["render",c]]);var f=w}}]);
//# sourceMappingURL=635.85266ee1.js.map